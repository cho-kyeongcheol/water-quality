{% extends "backend/layout/base.html" %}

{% block content %}
    <div class="pd-20 debug mt-30">
        <div class="title">측정 및 예측 기간</div>
        <span style="font-size:13px;">시작일 선택시 종료일(시작일 10일 후) 및 예측기간(종료일 이후 5일간)은 자동 설정됩니다.</span>
        <div class="row period-box">
            <div class="col">

                <div class="row">
                    <div class="col-6">
                        <label for="start-train" class="form-label">시작일</label>
                        <input type="text" class="form-control" id="start-train" placeholder="yyyy.mm.dd">
                    </div>
                    <div class="col-6">
                        <label for="end-train" class="form-label">종료일</label>
                        <input type="text" class="form-control" id="end-train" placeholder="yyyy.mm.dd" disabled>
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="row">
                    <div class="col-6">
                        <label for="start-predict" class="form-label">예측 시작일</label>
                        <input type="text" class="form-control" id="start-predict" placeholder="yyyy.mm.dd"
                               disabled>
                    </div>
                    <div class="col-6">
                        <label for="end-predict" class="form-label">예측 종료일</label>
                        <input type="text" class="form-control" id="end-predict" placeholder="yyyy.mm.dd" disabled>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascript %}
    <script>

        function formatDate(date) {
            var d = new Date(date),
                month = '' + (d.getMonth() + 1),
                day = '' + d.getDate(),
                year = d.getFullYear();
            if (month.length < 2)
                month = '0' + month;
            if (day.length < 2)
                day = '0' + day;
            return [year, month, day].join('.');
        }

        var _startTrain = new Date($("#start-train").val());
        var _endTrain = new Date();
        var _startPredict = new Date();
        var _endPredict = new Date();
        $(function () {
            var datepicker_param = {
                dateFormat: 'yy.mm.dd',
                prevText: '이전 달',
                nextText: '다음 달',
                monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
                monthNamesShort: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
                dayNames: ['일', '월', '화', '수', '목', '금', '토'],
                dayNamesShort: ['일', '월', '화', '수', '목', '금', '토'],
                dayNamesMin: ['일', '월', '화', '수', '목', '금', '토'],
                showMonthAfterYear: true,
                yearSuffix: '년'
            }

            $("#start-train").datepicker(datepicker_param);
            $("#end-train").datepicker(datepicker_param);
            $("#start-predict").datepicker(datepicker_param);
            $("#end-predict").datepicker(datepicker_param);


            $('#start-train').change(function () {
                let a = new Date('2019-01-01');
                let b = new Date('2020-12-31');
                _startTrain = new Date($("#start-train").val());
                if (a < _startTrain && b > _startTrain) {
                    _endTrain = new Date($("#start-train").val());
                    _startPredict = new Date($("#start-train").val());
                    _endPredict = new Date($("#start-train").val());

                    _endTrain.setDate(_startTrain.getDate() + 9);
                    _startPredict.setDate(_startTrain.getDate() + 10);
                    _endPredict.setDate(_startTrain.getDate() + 14);

                    let AA = formatDate(_endTrain);
                    $('#end-train').datepicker("setDate", AA);

                    let BB = formatDate(_startPredict);
                    $('#start-predict').datepicker("setDate", BB);

                    let CC = formatDate(_endPredict);
                    $('#end-predict').datepicker("setDate", CC);
                }else{
                    alert("2019~2020년 사이의 날짜만 입력가능합니다.");
                    $('#start-train').val('');
                }


            })

        });
    </script>
{% endblock %}
